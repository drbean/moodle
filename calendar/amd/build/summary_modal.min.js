define(["jquery","core/str","core/notification","core/custom_interaction_events","core/modal","core/modal_registry","core/modal_factory","core/modal_events","core_calendar/repository","core_calendar/events","core_calendar/modal_delete"],function(a,b,c,d,e,f,g,h,i,j,k){function l(d,e){var f,l=[{key:"deleteevent",component:"calendar"}],m=parseInt(d.getEventCount(),10),n=m>1;n?(l.push({key:"confirmeventseriesdelete",component:"calendar",param:{name:e,count:m}}),f=g.create({type:k.TYPE},d.getDeleteButton())):(l.push({key:"confirmeventdelete",component:"calendar",param:e}),f=g.create({type:g.types.SAVE_CANCEL},d.getDeleteButton()));var o=d.getEventId(),p=b.get_strings(l);a.when(p,f).then(function(b,e){return e.setTitle(b[0]),e.setBody(b[1]),n||e.setSaveButtonText(b[0]),e.getRoot().on(h.save,function(){i.deleteEvent(o,!1).then(function(){a("body").trigger(j.deleted,[o,!1]),d.hide()})["catch"](c.exception)}),e.getRoot().on(j.deleteAll,function(){i.deleteEvent(o,!0).then(function(){a("body").trigger(j.deleted,[o,!0]),d.hide()})["catch"](c.exception)}),e}).fail(c.exception)}var m=!1,n={ROOT:"[data-region='summary-modal-container']",EDIT_BUTTON:'[data-action="edit"]',DELETE_BUTTON:'[data-action="delete"]'},o=function(a){e.call(this,a)};return o.TYPE="core_calendar-event_summary",o.prototype=Object.create(e.prototype),o.prototype.constructor=o,o.prototype.getEditButton=function(){return"undefined"==typeof this.editButton&&(this.editButton=this.getFooter().find(n.EDIT_BUTTON)),this.editButton},o.prototype.getDeleteButton=function(){return"undefined"==typeof this.deleteButton&&(this.deleteButton=this.getFooter().find(n.DELETE_BUTTON)),this.deleteButton},o.prototype.getEventId=function(){return this.getBody().find(n.ROOT).attr("data-event-id")},o.prototype.getEventCount=function(){return this.getBody().find(n.ROOT).attr("data-event-event-count")},o.prototype.getEditUrl=function(){return this.getBody().find(n.ROOT).attr("data-edit-url")},o.prototype.isActionEvent=function(){return"true"==this.getBody().find(n.ROOT).attr("data-action-event")},o.prototype.registerEventListeners=function(){e.prototype.registerEventListeners.call(this),this.getRoot().on(h.bodyRendered,function(){var a=this.getBody().find(n.ROOT).attr("data-event-title");l(this,a)}.bind(this)),d.define(this.getEditButton(),[d.events.activate]),this.getEditButton().on(d.events.activate,function(b,c){this.isActionEvent()?a("body").trigger(j.editActionEvent,[this.getEditUrl()]):a("body").trigger(j.editEvent,[this.getEventId()]),this.hide(),b.preventDefault(),b.stopPropagation(),c.originalEvent.preventDefault(),c.originalEvent.stopPropagation()}.bind(this))},m||(f.register(o.TYPE,o,"core_calendar/event_summary_modal"),m=!0),o});